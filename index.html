<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1.0"/>
<title>Switzerland → Puglia → Rome — Oct 9–20, 2025</title>
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
<style>
  :root{
    --bg:#0b0e11; --panel:#12161b; --muted:#9aa4af; --ink:#e8eef6; --accent:#82aaff;
    --chip:#202632; --ok:#66C08B; --fly:#7B9FF2; --train:#3EA6D6; --onward:#FF7B6B; --border:#1f2430;
  }
  *{box-sizing:border-box}
  html,body{height:100%;margin:0;background:var(--bg);color:var(--ink);font:14px/1.45 system-ui,-apple-system,Segoe UI,Roboto,Arial}
  #app{display:grid;grid-template-columns:420px 1fr;grid-template-rows:100vh;overflow:hidden}
  /* Left: controls + details (stacked, scrolls) */
  #left{display:flex;flex-direction:column;min-width:320px;background:var(--panel);border-right:1px solid var(--border)}
  .bar{padding:14px 16px;border-bottom:1px solid var(--border)}
  .title{margin:0;font-weight:700;font-size:16px}
  .sub{color:var(--muted);font-size:12px;margin-top:4px}
  .bulk{display:flex;gap:8px;margin-top:10px}
  .btn{cursor:pointer;background:#0e1318;border:1px solid var(--border);color:#d8e0ea;border-radius:8px;padding:6px 10px;font-size:12px}
  .btn:hover{border-color:#2a3140}
  #list{overflow:auto;border-bottom:1px solid var(--border)}
  .day{display:flex;gap:10px;align-items:flex-start;padding:10px 14px;border-left:3px solid transparent;cursor:pointer}
  .day:hover{background:#0e1318}
  .day.active{background:#0e1318;border-left-color:var(--accent)}
  .day input{margin-top:2px;cursor:pointer}
  .d-head{font-weight:700}
  .d-sub{color:var(--muted);font-size:12px}
  /* Details area */
  #detail{overflow:auto}
  .section{padding:12px 16px;border-bottom:1px solid var(--border)}
  .section h3{margin:0 0 8px;font-size:13px;color:#cbd5e1}
  .grid{display:grid;grid-template-columns:1fr;gap:8px}
  .card{background:#0e1318;border:1px solid var(--border);border-radius:10px;padding:10px}
  .row{display:flex;justify-content:space-between;gap:8px}
  .muted{color:var(--muted)}
  .tag{display:inline-block;background:#111827;border:1px solid var(--border);border-radius:6px;padding:2px 6px;margin-right:6px;font-size:11px;color:#cbd5e1}
  .flow{display:flex;gap:8px;flex-wrap:wrap}
  .seg{background:#0c1220;border:1px solid var(--border);border-radius:999px;padding:2px 8px;font-size:11px}
  .seg.train{border-color:var(--train)}
  .seg.fly{border-color:var(--fly)}
  .seg.onward{border-color:var(--onward)}
  a{color:var(--accent);text-decoration:none}
  a:hover{text-decoration:underline}
  /* Right: pure map */
  #map{height:100%;width:100%}
  @media(max-width:1024px){ #app{grid-template-columns:1fr} #map{height:50vh} }
</style>
</head>
<body>
<div id="app">
  <aside id="left" aria-label="Itinerary controls and details">
    <div class="bar">
      <h1 class="title">Trip Planner · Oct 9–20</h1>
      <div class="sub">Switzerland → Puglia → Rome</div>
      <div class="bulk">
        <button class="btn" id="allOn">Select all</button>
        <button class="btn" id="allOff">Select none</button>
      </div>
    </div>

    <div id="list" aria-label="Toggle days"></div>

    <div id="detail" aria-live="polite">
      <div class="section">
        <h3>How this works</h3>
        <div class="muted">Tick/untick days to show on map. Click a day to zoom and see details here.</div>
      </div>
    </div>
  </aside>

  <main>
    <div id="map" aria-label="Map of Switzerland and Italy"></div>
  </main>
</div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
/* ===== Data ===== */
const P = {
  Lucerne:[47.0502,8.3093], ZRH:[47.4515,8.5646], Engelberg:[46.821,8.405],
  Vitznau:[47.013,8.487], Weggis:[47.032,8.432], RigiKaltbad:[47.045,8.465], RigiKulm:[47.058,8.486],
  Bari:[41.1171,16.8719], Monopoli:[40.9508,17.3026], Polignano:[40.9963,17.2208],
  Alberobello:[40.7833,17.2333], Locorotondo:[40.755,17.327], Ostuni:[40.7310,17.5776],
  Rome:[41.9028,12.4964], FCO:[41.7999,12.2462]
};

const DAYS = [
  {date:'Oct 9, Thu', city:'Lucerne', title:'Arrive Zurich → Lucerne',
   weather:{avg:'12–16°C', note:'Partly sunny'},
   travel:[{mode:'train', from:'ZRH', to:'Lucerne', time:'~1h10', km:'~67 km'}],
   slots:[
     {when:'12:30–13:30', what:'Lunch · Pfistern (river balcony)', link:'https://www.zunfthausrestaurant-pfistern.ch/'},
     {when:'14:00–16:30', what:'Old Town loop · Chapel Bridge → Jesuit Church → Spreuer Bridge'},
     {when:'17:00–18:30', what:'Musegg Wall & Zytturm views'},
     {when:'19:30', what:'Dinner · Old Swiss House', link:'https://www.oldswisshouse.ch/'}
   ],
   food:[
     {name:'Pfistern', why:'Lake fish & rösti', link:'https://www.zunfthausrestaurant-pfistern.ch/'},
     {name:'Old Swiss House', why:'Tableside schnitzel', link:'https://www.oldswisshouse.ch/'}
   ],
   nearby:[{name:'KKL lakefront', why:'Evening reflections'}],
   map:{
     pins:[
       {kind:'base', label:'Lucerne (Base)', at:'Lucerne'},
       {kind:'hub', label:'Zurich Airport', at:'ZRH'}
     ],
     legs:[['ZRH','Lucerne','train','Lucerne ←→ ZRH · ~67 km · 1h10']]
   }
  },
  {date:'Oct 10, Fri', city:'Lucerne', title:'Lake Promenade + Transport Museum',
   weather:{avg:'11–15°C', note:'Partly cloudy'},
   travel:[],
   slots:[
     {when:'09:30–11:00', what:'Lake Promenade · Schweizerhofquai → Hofkirche'},
     {when:'11:30–13:00', what:'Short cruise to Weggis/Vitznau'},
     {when:'15:00–17:00', what:'Swiss Museum of Transport + Chocolate Adventure'}
   ],
   food:[
     {name:'Seehotel Hermitage (terrace)', why:'Lunch with lake view', link:'https://www.hermitage.ch/en/'},
     {name:'Wirtshaus Galliker', why:'Luzerner Chügelipastete', link:'https://maps.app.goo.gl/6S2d4tP6FbXJHbcn6'}
   ],
   nearby:[{name:'Hofkirche', why:'Twin‑tower landmark'}],
   map:{pins:[{kind:'base', label:'Lucerne', at:'Lucerne'}], legs:[]}
  },
  {date:'Oct 11, Sat', city:'Lucerne', title:'Rigi Loop (boat + cog + cable)',
   weather:{avg:'6–12°C', note:'Clearer a.m.'},
   travel:[
     {mode:'boat', from:'Lucerne', to:'Vitznau', time:'~1h'},
     {mode:'cog', from:'Vitznau', to:'RigiKaltbad', time:'~25m'},
     {mode:'cog', from:'RigiKaltbad', to:'RigiKulm', time:'~30m'},
     {mode:'cable', from:'RigiKaltbad', to:'Weggis', time:'~10m'},
     {mode:'boat', from:'Weggis', to:'Lucerne', time:'~45m'},
   ],
   slots:[
     {when:'08:12', what:'Boat Lucerne → Vitznau (right side views)'},
     {when:'09:20–10:30', what:'Cogwheel to Rigi Kaltbad · Rigiland playground'},
     {when:'10:30–11:00', what:'Continue to Rigi Kulm (panorama)'},
     {when:'12:00', what:'Lunch · BärgGnuss (Älplermagronen)'},
     {when:'13:30–15:00', what:'Spa or ridge stroll'},
     {when:'15:30–16:30', what:'Cable to Weggis · boat back'}
   ],
   food:[{name:'BärgGnuss', why:'Cozy alpine lunch', link:'https://www.baerggnuss.ch/'}],
   nearby:[{name:'Mineralbad Rigi Kaltbad', why:'Warm pools with views'}],
   map:{
     pins:[
       {kind:'base', label:'Lucerne', at:'Lucerne'},
       {kind:'hub', label:'Vitznau pier', at:'Vitznau'},
       {kind:'day', label:'Rigi Kaltbad', at:'RigiKaltbad'},
       {kind:'day', label:'Rigi Kulm', at:'RigiKulm'},
       {kind:'hub', label:'Weggis cable', at:'Weggis'}
     ],
     legs:[
       ['Lucerne','Vitznau','regional','Boat · ~1h'],
       ['Vitznau','RigiKaltbad','regional','Cog · ~25m'],
       ['RigiKaltbad','RigiKulm','regional','Cog · ~30m'],
       ['RigiKaltbad','Weggis','regional','Cable · ~10m'],
       ['Weggis','Lucerne','regional','Boat · ~45m']
     ]
   }
  },
  {date:'Oct 12, Sun', city:'Lucerne', title:'Titlis Snow Day (Engelberg)',
   weather:{avg:'-3–4°C summit', note:'Cold, bright'},
   travel:[{mode:'train', from:'Lucerne', to:'Engelberg', time:'43m'}],
   slots:[
     {when:'08:00', what:'Train Lucerne → Engelberg'},
     {when:'09:15–09:45', what:'Titlis Xpress + Rotair to summit (3,020 m)'},
     {when:'10:00–14:00', what:'Cliff Walk, Glacier Cave, snow play'},
     {when:'12:30', what:'Lunch · Panorama Restaurant'}
   ],
   food:[{name:'Panorama Restaurant', why:'Window seats over snow', link:'https://www.titlis.ch/en'}],
   nearby:[{name:'Trübsee', why:'Playground & lake'}],
   map:{pins:[{kind:'base', label:'Lucerne', at:'Lucerne'},{kind:'day', label:'Engelberg', at:'Engelberg'}], legs:[['Lucerne','Engelberg','train','Train · 43m']]}
  },
  {date:'Oct 13, Mon', city:'Monopoli', title:'Fly Zurich → Bari · Base Monopoli',
   weather:{avg:'20–23°C', note:'Mild, breezy'},
   travel:[
     {mode:'train', from:'Lucerne', to:'ZRH', time:'1h10', km:'~67 km'},
     {mode:'flight', from:'ZRH', to:'Bari', time:'1h50', km:'~950 km'},
     {mode:'regional', from:'Bari', to:'Monopoli', time:'30m', km:'~45 km'}
   ],
   slots:[
     {when:'17:00–18:30', what:'Bastione Santa Maria sunset · Cala Porta Vecchia dip'},
     {when:'20:00', what:'Dinner · Osteria Perricci', link:'https://maps.app.goo.gl/D3jPbAvhbxRMVcnG9'}
   ],
   food:[{name:'Osteria Perricci', why:'Harbour classic'}],
   nearby:[{name:'Porto Vecchio', why:'Fishing boats + nets'}],
   map:{
     pins:[{kind:'hub', label:'Zurich Airport', at:'ZRH'},{kind:'hub', label:'Bari (hub)', at:'Bari'},{kind:'base', label:'Monopoli (Base)', at:'Monopoli'}],
     legs:[['Lucerne','ZRH','train','Train · ~1h10 (~67 km)'],['ZRH','Bari','flight','Flight · ~1h50 (~950 km)'],['Bari','Monopoli','regional','Regionale · 30m (~45 km)']]
   }
  },
  {date:'Oct 14, Tue', city:'Monopoli', title:'Polignano a Mare day',
   weather:{avg:'20–22°C', note:'Partly sunny'},
   travel:[{mode:'regional', from:'Monopoli', to:'Polignano', time:'10–15m'}],
   slots:[{when:'AM', what:'Terrazza S. Stefano · Lama Monachile cove'},{when:'13:00', what:'Lunch · Pescaria', link:'https://www.pescaria.it/'}],
   food:[{name:'Pescaria', why:'Seafood panini'}],
   nearby:[{name:'Grotta Palazzese terrace', why:'Iconic cliff drink stop'}],
   map:{pins:[{kind:'base', label:'Monopoli', at:'Monopoli'},{kind:'day', label:'Polignano a Mare', at:'Polignano'}], legs:[['Monopoli','Polignano','regional','Train · 10–15m']]}
  },
  {date:'Oct 15, Wed', city:'Monopoli', title:'Alberobello + Locorotondo',
   weather:{avg:'18–21°C', note:'Mild'},
   travel:[{mode:'regional', from:'Monopoli', to:'Alberobello', time:'~1–1.5h'},{mode:'regional', from:'Alberobello', to:'Locorotondo', time:'~15m'}],
   slots:[
     {when:'AM', what:'Alberobello · Rione Monti & Aia Piccola'},
     {when:'12:30', what:'Lunch · Terra Madre', link:'https://www.terramadrealberobello.it/'},
     {when:'PM', what:'Locorotondo · belvedere views'}
   ],
   food:[{name:'Terra Madre', why:'Garden‑to‑table'}],
   nearby:[{name:'Itria Valley', why:'Vines & dry‑stone walls'}],
   map:{pins:[{kind:'base', label:'Monopoli', at:'Monopoli'},{kind:'day', label:'Alberobello', at:'Alberobello'},{kind:'day', label:'Locorotondo', at:'Locorotondo'}],
        legs:[['Monopoli','Alberobello','regional','Train/bus · ~1–1.5h'],['Alberobello','Locorotondo','regional','Local · ~15m'],['Locorotondo','Monopoli','regional','Return · ~1h']]}
  },
  {date:'Oct 16, Thu', city:'Monopoli', title:'Ostuni + Monopoli coves',
   weather:{avg:'18–21°C', note:'Breezy'},
   travel:[{mode:'regional', from:'Monopoli', to:'Ostuni', time:'35–45m + taxi 10m'}],
   slots:[
     {when:'AM', what:'Ostuni · white city lanes & cathedral square'},
     {when:'12:30', what:'Lunch · Osteria del Tempo Perso', link:'https://www.osteriadeltempoperso.com/'},
     {when:'PM', what:'Porto Bianco/Nero swim back in Monopoli'}
   ],
   food:[{name:'Osteria del Tempo Perso', why:'Cave dining'},{name:'Terrazzamare', why:'Aperitivo rooftop'}],
   nearby:[{name:'Olive groves below Ostuni', why:'Adriatic views'}],
   map:{pins:[{kind:'base', label:'Monopoli', at:'Monopoli'},{kind:'day', label:'Ostuni', at:'Ostuni'}], legs:[['Monopoli','Ostuni','regional','Train · 35–45m + taxi']]}
  },
  {date:'Oct 17, Fri', city:'Monopoli', title:'Slow Monopoli',
   weather:{avg:'19–22°C', note:'Calm'},
   travel:[],
   slots:[
     {when:'AM', what:'Fish market & Porto Vecchio'},
     {when:'13:00', what:'Lunch · Piazza Palmieri'},
     {when:'20:00', what:'Dinner · Angelo’s'}
   ],
   food:[{name:'Piazza Palmieri', why:'Seasonal seafood'},{name:"Angelo’s", why:'Refined Pugliese'}],
   nearby:[{name:'Bastione Santa Maria', why:'Golden‑hour stroll'}],
   map:{pins:[{kind:'base', label:'Monopoli', at:'Monopoli'}], legs:[]}
  },
  {date:'Oct 18, Sat', city:'Monopoli', title:'Flex / Weather buffer',
   weather:{avg:'18–21°C', note:'TBD'},
   travel:[],
   slots:[
     {when:'Option sun', what:'Boat along Monopoli coves; repeat Polignano golden hour'},
     {when:'Option cloud', what:'Martina Franca baroque old town + café'}
   ],
   food:[], nearby:[], map:{pins:[{kind:'base', label:'Monopoli', at:'Monopoli'}], legs:[]}
  },
  {date:'Oct 19, Sun', city:'Rome', title:'Monopoli → Rome (one night)',
   weather:{avg:'18–22°C', note:'Mild'},
   travel:[{mode:'train', from:'Monopoli', to:'Rome', time:'~4h', km:'~490 km'}],
   slots:[
     {when:'PM', what:'Monti lanes → Forum/Colosseum exteriors'},
     {when:'20:00', what:'Dinner · Roscioli', link:'https://www.salumeriaroscioli.com/'},
     {when:'After', what:'Trevi Fountain by night'}
   ],
   food:[{name:'Roscioli', why:'Carbonara benchmark', link:'https://www.salumeriaroscioli.com/'}],
   nearby:[{name:'Villa Borghese (for Oct 20 AM)', why:'Rowboats & skyline'}],
   map:{pins:[{kind:'base', label:'Rome (Monti)', at:'Rome'}], legs:[['Monopoli','Rome','onward','Frecciarossa/Frecciargento · ~4h (~490 km)']]}
  },
  {date:'Oct 20, Mon', city:'Rome', title:'Flight 15:45 → Bengaluru',
   weather:{avg:'18–22°C', note:'Fair'},
   travel:[{mode:'alt', from:'Rome', to:'FCO', time:'Taxi 45–60m (or Leonardo Express 32m)'}],
   slots:[
     {when:'AM', what:'Sant’Eustachio coffee · short Villa Borghese stroll'},
     {when:'12:15', what:'Leave for FCO · buffer 2+ hrs'}
   ],
   food:[{name:'Sant’Eustachio Il Caffè', why:'Classic Roman espresso'}],
   nearby:[],
   map:{pins:[{kind:'hub', label:'FCO Airport', at:'FCO'}], legs:[['Rome','FCO','alt','Transfer · 45–60m (or 32m train)']]}
  }
];

/* ===== Map ===== */
const map = L.map('map',{center:[44.2,12.5],zoom:6,minZoom:5});
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',{maxZoom:18,attribution:'&copy; OpenStreetMap contributors'}).addTo(map);

function icon(color){
  return L.icon({
    iconUrl:`https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-${color}.png`,
    iconSize:[25,41], iconAnchor:[12,41], popupAnchor:[1,-34],
    shadowUrl:'https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png', shadowSize:[41,41]
  });
}
const ICON = {base:icon('blue'), day:icon('green'), hub:icon('grey')};
const COLORS = {train:'#3EA6D6', flight:'#7B9FF2', regional:'#66C08B', onward:'#FF7B6B', alt:'#9aa0a6'};

const layersByDay = [];
function drawLayer(i){
  if(layersByDay[i]) return layersByDay[i];
  const g = L.featureGroup();
  const d = DAYS[i];
  (d.map?.pins||[]).forEach(p=>{
    const pt=P[p.at]; if(!pt) return;
    const ic = p.kind==='base'?ICON.base : p.kind==='day'?ICON.day : ICON.hub;
    L.marker(pt,{icon:ic}).addTo(g).bindPopup(`<b>${p.label||p.at}</b>`);
  });
  (d.map?.legs||[]).forEach(([from,to,kind,label])=>{
    const a=P[from], b=P[to]; if(!a||!b) return;
    L.polyline([a,b],{color:COLORS[kind]||'#9aa0a6',weight:3,opacity:0.9,dashArray:(kind==='alt'?'6 6':null)})
     .addTo(g).bindTooltip(label,{sticky:true});
  });
  layersByDay[i]=g; return g;
}
const visibleGroup = L.featureGroup().addTo(map);
function fitVisible(){
  const Ls = visibleGroup.getLayers(); if(!Ls.length) return;
  let bounds=null; Ls.forEach(l=>{ bounds=bounds?bounds.extend(l.getBounds()):l.getBounds(); });
  if(bounds) map.fitBounds(bounds.pad(0.25));
}

/* ===== Left list: toggles & details ===== */
const list = document.getElementById('list');
function renderList(){
  DAYS.forEach((d,i)=>{
    const row = document.createElement('div'); row.className='day'; row.dataset.idx=i;
    const cb  = document.createElement('input'); cb.type='checkbox'; cb.checked=true;
    const wrap= document.createElement('div');
    wrap.innerHTML = `<div class="d-head">${d.date} — ${d.city}</div><div class="d-sub">${d.title}</div>`;
    row.appendChild(cb); row.appendChild(wrap); list.appendChild(row);

    // ensure drawn & visible initially
    visibleGroup.addLayer(drawLayer(i));

    cb.addEventListener('change', ()=>{
      const layer = drawLayer(i);
      if(cb.checked) visibleGroup.addLayer(layer); else visibleGroup.removeLayer(layer);
      fitVisible();
    });

    row.addEventListener('click', (e)=>{
      if(e.target===cb) return;
      document.querySelectorAll('.day').forEach(n=>n.classList.remove('active'));
      row.classList.add('active');
      const layer = drawLayer(i);
      if(!visibleGroup.hasLayer(layer)){ visibleGroup.addLayer(layer); cb.checked = true; }
      map.fitBounds(layer.getBounds().pad(0.25));
      renderDetail(i);
    });
  });
}
renderList();
fitVisible();

// bulk buttons
document.getElementById('allOn').onclick = ()=>{
  DAYS.forEach((_,i)=>{
    const layer = drawLayer(i);
    if(!visibleGroup.hasLayer(layer)) visibleGroup.addLayer(layer);
    list.querySelectorAll('.day input')[i].checked = true;
  });
  fitVisible();
};
document.getElementById('allOff').onclick = ()=>{
  visibleGroup.clearLayers();
  list.querySelectorAll('.day input').forEach(cb=>cb.checked=false);
};

// detail drawer
function chip(t){ return `<span class="tag">${t}</span>`; }
function renderDetail(i){
  const d = DAYS[i];
  const detail = document.getElementById('detail');
  const sections = [];

  sections.push(`
    <div class="section">
      <h3>${d.date} · ${d.city}</h3>
      <div class="muted">${d.title}</div>
    </div>
  `);

  sections.push(`
    <div class="section">
      <h3>Expected weather</h3>
      <div class="row">
        <div>${chip(d.weather.avg)} ${d.weather.note}</div>
        <div class="muted">Live weather can be added later</div>
      </div>
    </div>
  `);

  if(d.travel?.length){
    sections.push(`<div class="section"><h3>Travel</h3><div class="flow">`+
      d.travel.map(t=>{
        const cls = t.mode==='flight'?'seg fly':t.mode==='train'?'seg train':t.mode==='onward'?'seg onward':'seg';
        return `<span class="${cls}">${t.from} → ${t.to} · ${t.time}${t.km?` · ${t.km}`:''}</span>`;
      }).join('')+`</div></div>`);
  }

  if(d.slots?.length){
    sections.push(`<div class="section"><h3>Plan</h3><div class="grid">`+
      d.slots.map(s=>`<div class="card">
        <div class="row"><b>${s.when}</b><span class="muted">${d.city}</span></div>
        <div>${ s.link ? `<a target="_blank" href="${s.link}">${s.what}</a>` : s.what }</div>
      </div>`).join('')+`</div></div>`);
  }

  if(d.food?.length){
    sections.push(`<div class="section"><h3>Restaurants</h3><div class="grid">`+
      d.food.map(f=>`<div class="card"><div><b>${f.name}</b></div><div class="muted">${f.why||''}</div>${ f.link?`<div><a target="_blank" href="${f.link}">Website</a></div>`:''}</div>`).join('')+
      `</div></div>`);
  }

  if(d.nearby?.length){
    sections.push(`<div class="section"><h3>Places around</h3><div class="grid">`+
      d.nearby.map(n=>`<div class="card"><div><b>${n.name}</b></div><div class="muted">${n.why||''}</div></div>`).join('')+
      `</div></div>`);
  }

  detail.innerHTML = sections.join('');
}

// open first day by default
document.querySelector('.day')?.click();
</script>
</body>
</html>
